<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Inventario - Consulta</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h2 { margin-bottom: 10px; }
    input, button { padding: 8px; margin: 5px; border: none; cursor: pointer; }
    #btnAll { background-color: #4CAF50; color: white; }
    #btnClear { background-color: gray; color: white; }
    #contador { font-size: 18px; margin: 15px 0; font-weight: bold; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background: #f4f4f4; }
  </style>
</head>
<body>

<h2>Inventario de Cómputo</h2>

<div>
  <input type="text" id="buscar" placeholder="Buscar por empleado...">
  <button id="btnAll">Mostrar todo</button>
  <button id="btnClear">Limpiar</button>
</div>

<div id="contador"></div>

<table id="tabla">
  <thead><tr id="thead"></tr></thead>
  <tbody id="tbody"></tbody>
</table>

<script>
// ⚠️ Sustituye con tu enlace CSV publicado en Google Sheets
const URL = "TU_URL_CSV_AQUI";

let filas = [];
const tbody = document.getElementById("tbody");
const thead = document.getElementById("thead");
const contador = document.getElementById("contador");
const inputBuscar = document.getElementById("buscar");

// ✅ Columnas que vamos a mostrar en pantalla
const columnasVisibles = ["Empleado","Area","Oficina","Marca","Modelo","Serie","Procesador","Tipo"];

fetch(URL)
  .then(res => res.text())
  .then(csv => {
    filas = csv.trim().split("\n").map(r => r.split(","));
    construirVista();
  })
  .catch(err => console.error("Error cargando CSV:", err));

function construirVista() {
  const headers = filas[0];
  const rows = filas.slice(1);

  // Buscar índices de las columnas visibles
  const indices = columnasVisibles.map(c => headers.indexOf(c)).filter(i => i !== -1);

  // Construir encabezados
  thead.innerHTML = columnasVisibles.map(h => `<th>${h}</th>`).join("");
  tbody.innerHTML = "";

  const textoBusqueda = inputBuscar.value.trim().toLowerCase();

  const filtrados = rows.filter(r => {
    const empleado = (r[headers.indexOf("Empleado")] || "").toLowerCase();
    return textoBusqueda === "" || empleado.includes(textoBusqueda);
  });

  contador.textContent = `Total: ${filtrados.length}`;

  filtrados.forEach(fila => {
    const tr = document.createElement("tr");
    indices.forEach(i => {
      const td = document.createElement("td");
      td.textContent = fila[i] && fila[i].trim() !== "" ? fila[i] : "N/A";
      tr.appendChild(td);
    });
    tbody.appendChild(tr);
  });
}

// Buscar con Enter
inputBuscar.addEventListener("keypress", e => {
  if (e.key === "Enter") construirVista();
});

// Botón Mostrar todo
document.getElementById("btnAll").onclick = () => {
  inputBuscar.value = "";
  construirVista();
};

// Botón Limpiar
document.getElementById("btnClear").onclick = () => {
  inputBuscar.value = "";
  tbody.innerHTML = "";
  contador.textContent = "";
  thead.innerHTML = columnasVisibles.map(h => `<th>${h}</th>`).join("");
};
</script>

</body>
</html>
